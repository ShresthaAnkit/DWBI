create  database OLTP_ANKIT;
create  schema OLTP_ANKIT;

create  TABLE OLTP_ANKIT.CATEGORY (
	ID INT NOT NULL,
	CATEGORY_DESC VARCHAR(1024),
	primary key (ID)
);
create  TABLE OLTP_ANKIT.COUNTRY (
	ID INT NOT NULL,
	COUNTRY_DESC VARCHAR(256),
	primary key (ID)
);
create  TABLE OLTP_ANKIT.CUSTOMER (
	ID INT NOT NULL,
	CUSTOMER_FIRST_NAME VARCHAR(256),
	CUSTOMER_MIDDLE_NAME VARCHAR(256),
	CUSTOMER_LAST_NAME VARCHAR(256),
	CUSTOMER_ADDRESS VARCHAR(256),
	primary key (ID)
);
create  TABLE OLTP_ANKIT.SUBCATEGORY (
	ID INT NOT NULL,
	CATEGORY_ID INT,
	SUBCATEGORY_DESC VARCHAR(256),
	primary key (ID),
	foreign key (CATEGORY_ID) references OLTP_ANKIT.CATEGORY(ID)
);
create  TABLE OLTP_ANKIT.PRODUCT (
	ID INT NOT NULL,
	SUBCATEGORY_ID INT,
	PRODUCT_DESC VARCHAR(256),
	primary key (ID),
	foreign key (SUBCATEGORY_ID) references OLTP_ANKIT.SUBCATEGORY(ID)
);


create  TABLE OLTP_ANKIT.REGION (
	ID INT NOT NULL,
	COUNTRY_ID INT,
	REGION_DESC VARCHAR(256),
	primary key (ID),
	foreign key (COUNTRY_ID) references OLTP_ANKIT.COUNTRY(ID)
);
create  TABLE OLTP_ANKIT.STORE (
	ID INT NOT NULL,
	REGION_ID INT,
	STORE_DESC VARCHAR(256),
	primary key (ID),
	foreign key (REGION_ID) references OLTP_ANKIT.REGION(ID)
);
create  TABLE OLTP_ANKIT.SALES (
	ID INT NOT NULL,
	STORE_ID INT NOT NULL,
	PRODUCT_ID INT NOT NULL,
	CUSTOMER_ID INT,
	TRANSACTION_TIME TIME,
	QUANTITY INT,
	AMOUNT NUMBER(20,2),
	DISCOUNT NUMBER(20,2),
	primary key (ID),
	foreign key (STORE_ID) references OLTP_ANKIT.STORE(ID),
	foreign key (PRODUCT_ID) references OLTP_ANKIT.PRODUCT(ID),
	foreign key (CUSTOMER_ID) references OLTP_ANKIT.CUSTOMER(ID)
);

--Seed
--Insert into Country

INSERT INTO OLTP_ANKIT.COUNTRY VALUES
(1, 'Nepal'),
(2, 'India');

--Insert into Region

INSERT INTO OLTP_ANKIT.REGION VALUES
(1, 1, 'Kathmandu'),
(2, 1, 'Lalitpur'),
(3, 2, 'Punjab'),
(4, 2, 'Bangalore');


--insert into Store

INSERT INTO OLTP_ANKIT.STORE VALUES
(1, 1, 'RETAIL Chakrapath'),
(2, 2, 'RETAIL Pulchowk'),
(3, 3, 'RETAIL Chandigarh'),
(4, 4, 'RETAIL Jayanagar');

--Insert into Categories

INSERT INTO OLTP_ANKIT.CATEGORY VALUES
(1,'Garment'),
(2,'GROCERY'),
(3,'KitchenWares');

--Insert into SubCategories

Insert into OLTP_ANKIT.SUBCATEGORY values
(1, 1,'MENS WEAR'),
(2, 1,'WOMENS WEAR'),
(3,1,'KIDS WEAR'),
(4,2,'Dairy'),
(5,2,'Fruits'), 
(6,2,'Packed Items'),
(7,3,'Utensils') ,
(8,3,'Glassware'),
(9,3,'ElectricAppliances');


--Insert into Product
insert into OLTP_ANKIT.PRODUCT values
(1,1,'Jeans'),
(2,2,'Shirt'),
(3,1,'Shoes'),
(4,5,'Apple'),
(5,5,'Oranges'),
(6,4,'Milk'),
(7,4,'Butter'),
(8,9, 'Microwave'),
(9,9, 'Coffee Maker'),
(10,7, 'Plate'),
(11,6,'Wai Wai'),
(12,6,'Oats'),
(13,3,'Diaper'),
(14,8,'Glass'),
(15,8,'Jug'),
(16,2,'Skirt'),
(17,7,'Spoon'),
(18,3,'Kids Jacket');

--Insert into Customer

insert into OLTP_ANKIT.CUSTOMER values
(1,'Ram',null,'Adhikari','Kathmandu'),
(2,'Shyam','Prasad','Sharma','lalitpur'),
(3,'Hari',null,'Poudel','Bhaktapur'),
(4, 'Saurav','Muhammed', 'Ali','Banglore'),
(5,'Kannur','Lokesh','Rahul','Punjab'),
(6, 'James',null,'Singh','Chennai');
--
--DWH
--TGT
create  database OLAP_ANKIT_TGT;

create  TABLE OLAP_ANKIT_TGT.D_RETAIL_CNTRY_T (
  CNTRY_ID INT,
  CNTRY_KY INT NOT NULL autoincrement,
  CNTRY_DESC VARCHAR(50),
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint CNTRY_PK primary key (CNTRY_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_CTGRY_T (
  CTGRY_ID INT,
  CTGRY_KY INT NOT NULL autoincrement,
  CTGRY_DESC VARCHAR(50),
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint CTGRY_PK primary key (CTGRY_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_CUSTOMER_T (
  CUSTOMER_ID INT,
  CUSTOMER_KY INT NOT NULL autoincrement,
  CUSTOMER_FST_NM VARCHAR(20),
  CUSTOMER_MID_NM VARCHAR(20),
  CUSTOMER_LST_NM VARCHAR(20),
  CUSTOMER_ADDR VARCHAR(20),
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint CUSTOMER_PK primary key (CUSTOMER_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_LOCN_T (
  LOCN_ID INT,
  LOCN_KY INT NOT NULL autoincrement,
  RGN_KY INT,
  CNTRY_KY INT,
  LOCN_DESC VARCHAR(50),
  LAST_OPEN_TMS TIME,
  LAST_CLOSED_TMS TIME,
  ACTV_FLG VARCHAR(1),
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint LOCN_PK primary key (LOCN_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_PDT_T (
  PDT_ID INT,
  PDT_KY INT NOT NULL autoincrement,
  SUB_CTGRY_KY INT,
  CTGRY_KY INT,
  PDT_DESC VARCHAR(50),
  PRICE INT,
  ACTV_FLG VARCHAR(1),
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint PDT_PK primary key (PDT_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_RGN_T (
  RGN_ID INT,
  RGN_KY INT NOT NULL autoincrement,
  CNTRY_KY INT,
  RGN_DESC VARCHAR(50),
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint RGN_PK primary key (RGN_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_SUB_CTGRY_T (
  SUB_CTGRY_ID INT,
  SUB_CTGRY_KY INT NOT NULL autoincrement,
  CTGRY_KY INT,
  SUB_CTGRY_DESC VARCHAR(50),
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint SUB_CTGRY_PK primary key (SUB_CTGRY_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_DAY_T (
  ID DATE NOT NULL,
  DT_KY DATE NOT NULL,
  MONTH_KY INT,
  QUARTER_KY INT NOT NULL,
  YEAR_KY INT NOT NULL,
  HALF_YEAR_KY INT NOT NULL,
  DAY_START_TIME TIME NOT NULL,
  DAY_END_TIME TIME NOT NULL,
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint DAY_PK primary key (DT_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_HALF_YEAR_T (
  ID VARCHAR(16777216) NOT NULL,
  HALF_YEAR_KY INT NOT NULL,
  YEAR_KY INT NOT NULL,
  HALF_YEAR_START_DATE DATE NOT NULL,
  HALF_YEAR_END_DATE DATE NOT NULL,
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint HALF_YEAR_PK primary key (HALF_YEAR_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_HOUR_T (
  ID INT,
  HOUR_KY INT NOT NULL,
  constraint HOUR_PK primary key (HOUR_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_MIN_T (
  ID INT,
  MIN_KY INT NOT NULL,
  HOUR_KY INT,
  constraint MIN_PK primary key (MIN_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_MONTH_T (
  ID VARCHAR(16777216) NOT NULL,
  MONTH_KY INT NOT NULL,
  MONTH_DESC VARCHAR(16777216) NOT NULL,
  QUARTER_KY INT NOT NULL,
  YEAR_KY INT NOT NULL,
  HALF_YEAR_KY INT NOT NULL,
  MONTH_START_DATE DATE NOT NULL,
  MONTH_END_DATE DATE NOT NULL,
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint MONTH_PK primary key (MONTH_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_QUARTER_T (
  ID VARCHAR(16777216) NOT NULL,
  QUARTER_KY INT NOT NULL,
  YEAR_KY INT NOT NULL,
  HALF_YEAR_KY INT NOT NULL,
  QUARTER_START_DATE DATE NOT NULL,
  QUARTER_END_DATE DATE NOT NULL,
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint QUARTER_PK primary key (QUARTER_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_SEC_T (
  ID INT,
  SEC_KY INT NOT NULL,
  MIN_KY INT,
  HOUR_KY INT,
  constraint SEC_PK primary key (SEC_KY)
);
create  TABLE OLAP_ANKIT_TGT.D_RETAIL_TIME_YEAR_T (
  ID INT,
  YEAR_KY INT NOT NULL,
  YEAR_START_DATE DATE NOT NULL,
  YEAR_END_DATE DATE NOT NULL,
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint YEAR_PK primary key (YEAR_KY)
);
create  TABLE OLAP_ANKIT_TGT.F_RETAIL_AGG_SLS_PLC_MONTH_T (
  ROW_KEY INT NOT NULL autoincrement,
  PDT_KY INT NOT NULL,
  LOCN_KY INT NOT NULL,
  MONTH_KY INT NOT NULL,
  TOTAL_QTY INT,
  TOTAL_AMT INT,
  TOTAL_DSCNT INT,
  ROW_INSRT_TMS TIME NOT NULL,
  ROW_UPDT_TMS TIME NOT NULL,
  constraint SLS_AGG_PK primary key (ROW_KEY)
);
create  TABLE OLAP_ANKIT_TGT.F_RETAIL_SLS_T (
  ROW_KEY INT NOT NULL autoincrement,
  SLS_ID INT NOT NULL,
  LOCN_KY INT,
  DT_KY DATE,
  PDT_KY INT,
  CUSTOMER_KY INT,
  TRANSACTION_TIME TIME,
  QTY INT,
  AMT INT,
  DSCNT INT,
  OPEN_CLOSE_CD VARCHAR(1),
  ROW_INSRT_TMS TIME,
  ROW_UPDT_TMS TIME,
  constraint SLS_PK primary key (ROW_KEY)
);

CREATE
   TABLE OLAP_ANKIT_TGT.F_RETAIL_FRCST_SLS_T (
  DT_KY DATE,
  SLS_AMT_FCST INT
  );
--Tmp
create  TABLE OLAP_ANKIT_TEMP.AGG_SLS_PLC_MONTH (
  PDT_KY INT,
  STORE_KY INT,
  CTGRY_KY INT,
  MONTH_KY INT,
  TOTAL_QTY INT,
  TOTAL_AMT INT,
  TOTAL_DSCNT INT
);
create  TABLE OLAP_ANKIT_TEMP.CATEGORY (
  CTGRY_ID INT,
  CTGRY_DESC VARCHAR(50)
);
create  TABLE OLAP_ANKIT_TEMP.COUNTRY (
  CNTRY_ID INT,
  CNTRY_DESC VARCHAR(50)
);
create  TABLE OLAP_ANKIT_TEMP.CUSTOMER (
  CUSTOMER_ID INT,
  CUSTOMER_FST_NM VARCHAR(20),
  CUSTOMER_MID_NM VARCHAR(20),
  CUSTOMER_LST_NM VARCHAR(20),
  CUSTOMER_ADDR VARCHAR(20)
);
create  TABLE OLAP_ANKIT_TEMP.DAY (
  ID INT,
  MONTH_KY INT,
  QUARTER_KY INT,
  YEAR_KY INT,
  HALF_YEAR_KY INT,
  DAY_START_TIME TIME,
  DAY_END_TIME TIME
);
create  TABLE OLAP_ANKIT_TEMP.HALFYEAR (
  ID INT,
  YEAR_KY INT,
  HALF_YEAR_START_DATE DATE,
  HALF_YEAR_END_DATE DATE
);
create  TABLE OLAP_ANKIT_TEMP.HOUR (
  ID INT
);
create  TABLE OLAP_ANKIT_TEMP.MIN (
  ID INT,
  HOUR_KY INT
);
create  TABLE OLAP_ANKIT_TEMP.MONTH (
  ID INT,
  QUARTER_KY INT,
  YEAR_KY INT,
  HALF_YEAR_KY INT,
  MONTH_START_DATE DATE,
  MONTH_END_DATE DATE
);
create  TABLE OLAP_ANKIT_TEMP.PRODUCT (
  PDT_ID INT,
  SUB_CTGRY_KY INT,
  CTGRY_KY INT,
  PDT_DESC VARCHAR(50)
);
create  TABLE OLAP_ANKIT_TEMP.QUARTER (
  ID INT,
  YEAR_KY INT,
  HALF_YEAR_KY INT,
  QUARTER_START_DATE DATE,
  QUARTER_END_DATE DATE
);
create  TABLE OLAP_ANKIT_TEMP.REGION (
  RGN_ID INT,
  CNTRY_KY INT,
  RGN_DESC VARCHAR(50)
);
create  TABLE OLAP_ANKIT_TEMP.SALES (
  SLS_ID INT,
  STORE_KY INT,
  DT_KY DATE,
  PDT_KY INT,
  CUSTOMER_KY INT,
  TRANSACTION_TIME TIME,
  QTY INT,
  AMT INT,
  DSCNT INT
);
create  TABLE OLAP_ANKIT_TEMP.STORE (
  STORE_ID INT,
  RGN_KY INT,
  CNTRY_KY INT,
  STORE_DESC VARCHAR(50)
);
create  TABLE OLAP_ANKIT_TEMP.SUBCATEGORY (
  SUB_CTGRY_ID INT,
  CTGRY_KY INT,
  SUB_CTGRY_DESC VARCHAR(50)
);
create  TABLE OLAP_ANKIT_TEMP.YEAR (
  ID INT,
  YEAR_KY INT,
  YEAR_START_DATE DATE,
  YEAR_END_DATE DATE
);
--STG
  SUBCATEGORY_DESC VARCHAR(256),
  primary key (ID),
  foreign key (CATEGORY_ID) references OLAP_ANKIT_STG.CATEGORY(ID)
);
create  TABLE OLAP_ANKIT_STG.COUNTRY (
  ID INT NOT NULL,
  COUNTRY_DESC VARCHAR(256),
  primary key (ID)
);
create  TABLE OLAP_ANKIT_STG.CUSTOMER (
  ID INT NOT NULL,
  CUSTOMER_FIRST_NAME VARCHAR(256),
  CUSTOMER_MIDDLE_NAME VARCHAR(256),
  CUSTOMER_LAST_NAME VARCHAR(256),
  CUSTOMER_ADDRESS VARCHAR(256),
  primary key (ID)
);
create  TABLE OLAP_ANKIT_STG.PRODUCT (
  ID INT NOT NULL,
  SUBCATEGORY_ID INT,
  PRODUCT_DESC VARCHAR(256),
  primary key (ID),
  foreign key (SUBCATEGORY_ID) references OLAP_ANKIT_STG.SUBCATEGORY(ID)
);
create  TABLE OLAP_ANKIT_STG.REGION (
  ID INT NOT NULL,
  COUNTRY_ID INT,
  REGION_DESC VARCHAR(256),
  primary key (ID),
  foreign key (COUNTRY_ID) references OLAP_ANKIT_STG.COUNTRY(ID)
);
create  TABLE OLAP_ANKIT_STG.STORE (
  ID INT NOT NULL,
  REGION_ID INT,
  STORE_DESC VARCHAR(256),
  primary key (ID),
  foreign key (REGION_ID) references OLAP_ANKIT_STG.REGION(ID)
);
create  TABLE OLAP_ANKIT_STG.SALES (
  ID INT NOT NULL,
  STORE_ID INT NOT NULL,
  PRODUCT_ID INT NOT NULL,
  CUSTOMER_ID INT,
  TRANSACTION_TIME TIME,
  QUANTITY INT,
  AMOUNT NUMBER(20,2),
  DISCOUNT NUMBER(20,2),
  primary key (ID),
  foreign key (STORE_ID) references OLAP_ANKIT_STG.STORE(ID),
  foreign key (PRODUCT_ID) references OLAP_ANKIT_STG.PRODUCT(ID),
  foreign key (CUSTOMER_ID) references OLAP_ANKIT_STG.CUSTOMER(ID)
);

